# ============================================================================
# Test Profile Configuration
# ============================================================================

# Use Testcontainers PostgreSQL for production-like integration tests
# Testcontainers will automatically start a Docker container with PostgreSQL
spring.datasource.url=jdbc:tc:postgresql:15-alpine:///schoollibrary_test
spring.datasource.username=test
spring.datasource.password=test
spring.datasource.driver-class-name=org.testcontainers.jdbc.ContainerDatabaseDriver

# JPA configuration for testing
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.show-sql=false

# Flyway will run migrations automatically against the test container
spring.flyway.enabled=true

# Disable real Keycloak calls in tests by pointing JWT settings to a local dummy endpoint
spring.security.oauth2.resourceserver.jwt.issuer-uri=http://localhost/test-issuer
spring.security.oauth2.resourceserver.jwt.jwk-set-uri=http://localhost/test-jwks

# Reduce logging noise in tests
logging.level.root=WARN
logging.level.com.schoollibrary=INFO
logging.level.org.springframework=WARN
logging.level.org.springframework.security=WARN
